<Project>
  <PropertyGroup Label="Customizable settings">
    <LicenseFileName>LICENSE.txt</LicenseFileName>
    <ReadmeFileName>README.md</ReadmeFileName>
    <IconFileName>icon.png</IconFileName>

    <RepositoryRoot>$(MSBuildThisFileDirectory)../</RepositoryRoot>
    <ProjectRoot>$(MSBuildThisProjectDirectory)../../</ProjectRoot>
  </PropertyGroup>

  <PropertyGroup Label="Package metadata">
    <IsPackable>true</IsPackable>
    <BeforePack>_ValidateSettings</BeforePack>

    <Authors>Philipp Kiener</Authors>
    <Copyright>2019-2024 Philipp Kiener</Copyright>
    <PackageLicenseExpression>MIT</PackageLicenseExpression>

    <RepositoryType>git</RepositoryType>
    <PublishRepositoryUrl>true</PublishRepositoryUrl>
    <RepositoryUrl>https://github.com/phkiener/Swallow</RepositoryUrl>

    <PackageIcon>$(IconFileName)</PackageIcon>
    <PackageReadmeFile>$(ReadmeFileName)</PackageReadmeFile>
    <PackageProjectUrl>https://github.com/phkiener/Swallow</PackageProjectUrl>
  </PropertyGroup>

  <PropertyGroup Label="Build settings">
    <WarningsAsErrors>true</WarningsAsErrors>
    <GenerateDocumentationFile>true</GenerateDocumentationFile>
    <DebugType>embedded</DebugType>
    <EmbedAllSources>true</EmbedAllSources>
  </PropertyGroup>

  <PropertyGroup Label="Release build settings" Condition="$(Configuration) == 'Release'">
    <ContinuousIntegrationBuild>true</ContinuousIntegrationBuild>
    <Deterministic>true</Deterministic>
  </PropertyGroup>

  <PropertyGroup Label="Default file paths">
    <IconFilePath>$(RepositoryRoot)$(IconFileName)</IconFilePath>
    <IconFilePath Condition="EXISTS($(ProjectRoot)$(IconFileName))">$(ProjectRoot)$(IconFileName)</IconFilePath>

    <ReadmeFilePath>$(RepositoryRoot)$(ReadmeFileName)</ReadmeFilePath>
    <ReadmeFilePath Condition="EXISTS($(ProjectRoot)$(ReadmeFileName))">$(ProjectRoot)$(ReadmeFileName)</ReadmeFilePath>

    <LicenseFilePath>$(RepositoryRoot)$(LicenseFileName)</LicenseFilePath>
    <LicenseFilePath Condition="EXISTS($(ProjectRoot)$(LicenseFileName))">$(ProjectRoot)$(LicenseFileName)</LicenseFilePath>
  </PropertyGroup>

  <ItemGroup Label="Items included by default">
    <None Include="$(IconFilePath)" Pack="true" PackagePath="/" Visible="false" />
    <None Include="$(ReadmeFilePath)" Pack="true" PackagePath="/" Visible="false" />
    <None Include="$(LicenseFilePath)" Pack="true" PackagePath="/" Visible="false" />
  </ItemGroup>

  <Target Name="_ValidateSettings">
    <Error Text="Project &quot;$(MSBuildProjectName)&quot; is missing a description"
           Code="Metadata" File="$(MSBuildProjectFile)" Condition="$(Description) == ''" />

    <Error Text="Project &quot;$(MSBuildProjectName)&quot; is missing the package tags"
           Code="Metadata" File="$(MSBuildProjectFile)" Condition="$(PackageTags) == ''" />
  </Target>
</Project>
